(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[385],{36364:function(e,t,i){Promise.resolve().then(i.bind(i,47410))},47410:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return w}});var r=i(20881),o=i(64149),s=i(94920),a=i(37971),l=i(90270);let n=a.fC,d=a.xz,c=o.forwardRef((e,t)=>{let{className:i,align:o="center",sideOffset:s=4,...n}=e;return(0,r.jsx)(a.VY,{ref:t,align:o,sideOffset:s,className:(0,l.cn)("z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",i),...n})});c.displayName=a.VY.displayName;var f=i(395),u=i(36306),p=i(78580),m=i(33335),h=i(21501),v=i(88766),I=i(46646),g=i(47657);let x={imei:"",iccid:""},y={profile1:{...x},profile2:{...x}};var w=()=>{let[e,t]=(0,o.useState)(!0),[i,a]=(0,o.useState)(!1),[l,x]=(0,o.useState)(!1),[w,b]=(0,o.useState)(""),[j,E]=(0,o.useState)(""),[N,C]=(0,o.useState)(y),[M,S]=(0,o.useState)(y),{profiles:T,hasActiveProfile:P,updateIMEIProfile:O,deleteIMEIProfiles:D}=function(){let[e,t]=(0,o.useState)({}),[i,r]=(0,o.useState)(!0),[s,a]=(0,o.useState)(!1),l=async()=>{try{r(!0);let e=await fetch("/cgi-bin/cell-settings/imei-profiles/fetch-profile.sh",{method:"GET",headers:{"Content-Type":"application/x-www-form-urlencoded"},signal:AbortSignal.timeout(1e4)});if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));let i=await e.json();t(i),(i.profile1||i.profile2)&&a(!0)}catch(e){console.error("Error fetching IMEI profiles:",e)}finally{r(!1)}};(0,o.useEffect)(()=>{l()},[]);let n=async(i,r)=>{try{var o,s,a,l;let n=new URLSearchParams;"profile1"===i?(n.append("iccidProfile1",r.iccid),n.append("imeiProfile1",r.imei)):(n.append("iccidProfile1",(null===(o=e.profile1)||void 0===o?void 0:o.iccid)||""),n.append("imeiProfile1",(null===(s=e.profile1)||void 0===s?void 0:s.imei)||"")),("profile2"===i||e.profile2)&&(n.append("iccidProfile2","profile2"===i?r.iccid:(null===(a=e.profile2)||void 0===a?void 0:a.iccid)||""),n.append("imeiProfile2","profile2"===i?r.imei:(null===(l=e.profile2)||void 0===l?void 0:l.imei)||""));let d=await fetch("/cgi-bin/cell-settings/imei-profiles/save-profile.sh",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:n.toString(),signal:AbortSignal.timeout(1e4)});if(!d.ok)throw Error("Failed to update profile");let c=await d.json();if("success"===c.status)return t(e=>({...e,[i]:r})),!0;throw Error(c.message||"Failed to update profile")}catch(e){return console.error("Error updating ".concat(i,":"),e),!1}};return{profiles:e,hasActiveProfile:s,updateIMEIProfile:n,deleteIMEIProfiles:async()=>{try{let e=await fetch("/cgi-bin/cell-settings/imei-profiles/delete-profile.sh",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},signal:AbortSignal.timeout(1e4)});if(!e.ok)throw Error("Failed to delete profiles");let i=await e.json();if("success"===i.status)return t({}),!0;throw Error(i.message||"Failed to delete profiles")}catch(e){return console.error("Error deleting IMEI profiles:",e),!1}}}}(),{toast:_}=(0,I.pm)(),A=(0,o.useCallback)(async()=>{try{t(!0);let e=encodeURIComponent("AT+CGSN"),i=await fetch("/cgi-bin/atinout_handler.sh",{method:"POST",headers:{"Content-Type":"application/json"},body:"command=".concat(e)}),r=(await i.text()).match(/\d{15}/),o=r?r[0]:null;if(o)b(o),E(o);else throw Error("IMEI not found in response")}catch(e){_({title:"Failed to fetch IMEI",description:"Failed to fetch IMEI from the device",variant:"destructive"}),console.error(e)}finally{t(!1)}},[]);(0,o.useEffect)(()=>{if(A(),T){var e,t,i,r,o,s,a,l;S({profile1:{imei:(null===(e=T.profile1)||void 0===e?void 0:e.imei)||"",iccid:(null===(t=T.profile1)||void 0===t?void 0:t.iccid)||""},profile2:{imei:(null===(i=T.profile2)||void 0===i?void 0:i.imei)||"",iccid:(null===(r=T.profile2)||void 0===r?void 0:r.iccid)||""}}),C({profile1:{imei:(null===(o=T.profile1)||void 0===o?void 0:o.imei)||"",iccid:(null===(s=T.profile1)||void 0===s?void 0:s.iccid)||""},profile2:{imei:(null===(a=T.profile2)||void 0===a?void 0:a.imei)||"",iccid:(null===(l=T.profile2)||void 0===l?void 0:l.iccid)||""}})}},[A,T]);let F=async e=>{if(e.preventDefault(),t(!0),15!==j.length||isNaN(Number(j))){_({title:"Invalid IMEI",description:"IMEI must be 15 digits and numbers only",variant:"destructive"}),t(!1);return}try{let e='AT+EGMR=1,7,"'.concat(j,';+QPOWD=1"'),t=encodeURIComponent(e);if(!(await fetch("/cgi-bin/atinout_handler.sh",{method:"POST",headers:{"Content-Type":"application/json"},body:"command=".concat(t)})).ok)throw Error("Failed to update IMEI")}catch(e){_({title:"Failed to update IMEI",description:"Failed to update IMEI on the device",variant:"destructive"}),console.error(e)}finally{t(!1)}},R=()=>{if(!M.profile1.imei||!M.profile1.iccid)return _({variant:"destructive",title:"Invalid Profile 1",description:"Both IMEI and ICCID are required for Profile 1"}),!1;if(!/^\d{15}$/.test(M.profile1.imei))return _({variant:"destructive",title:"Invalid IMEI in Profile 1",description:"IMEI must be exactly 15 digits"}),!1;if(Object.values(M.profile2).some(e=>""!==e)){if(!M.profile2.imei||!M.profile2.iccid)return _({variant:"destructive",title:"Invalid Profile 2",description:"Both IMEI and ICCID are required if any Profile 2 field is filled"}),!1;if(!/^\d{15}$/.test(M.profile2.imei))return _({variant:"destructive",title:"Invalid IMEI in Profile 2",description:"IMEI must be exactly 15 digits"}),!1}return!0},k=async e=>{if(e.preventDefault(),R()){a(!0);try{await O("profile1",M.profile1),Object.values(M.profile2).some(e=>""!==e)&&await O("profile2",M.profile2),_({title:"Success",description:"IMEI profiles have been saved successfully. Rebooting...",duration:9e4}),setTimeout(()=>{window.location.reload()},9e4)}catch(e){_({variant:"destructive",title:"Error",description:"Failed to save IMEI profiles. Please try again."})}finally{a(!1)}}},z=async()=>{if(confirm("Are you sure you want to delete all IMEI profiles?")){x(!0);try{if(await D())S(y),_({title:"Success",description:"IMEI profiles have been deleted successfully"});else throw Error("Failed to delete profiles")}catch(e){_({variant:"destructive",title:"Error",description:"Failed to delete IMEI profiles. Please try again."})}finally{setTimeout(()=>{x(!1)},2e3)}}},Z=(e,t,i)=>{S(r=>({...r,[e]:{...r[e],[t]:i}}))};return(0,r.jsxs)("div",{className:"grid gap-8",children:[(0,r.jsx)(s.Zb,{children:(0,r.jsxs)("form",{onSubmit:F,children:[(0,r.jsxs)(s.Ol,{children:[(0,r.jsx)(s.ll,{children:"IMEI Mangling"}),(0,r.jsxs)(s.SZ,{className:"flex items-center justify-between",children:["Change the IMEI of the device.",(0,r.jsxs)("div",{className:"flex items-center text-orange-500",children:[(0,r.jsx)(f.Z,{className:"size-4 mr-1"}),"Do at your own risk!"]})]})]}),(0,r.jsx)(s.aY,{children:(0,r.jsxs)("div",{className:"grid w-full max-w-sm items-center gap-2",children:[(0,r.jsx)(h._,{htmlFor:"IMEI",children:"Change Current IMEI"}),e?(0,r.jsx)(v.O,{className:"h-8"}):(0,r.jsxs)("div",{className:"grid gap-1.5",children:[P?(0,r.jsx)("div",{className:"relative w-full",children:(0,r.jsxs)(n,{children:[(0,r.jsxs)(d,{children:[(0,r.jsx)(m.I,{className:"pr-9",placeholder:w,disabled:!0}),(0,r.jsx)(f.Z,{className:"absolute right-0 top-0 m-2.5 h-4 w-4 text-muted-foreground"})]}),(0,r.jsx)(c,{className:"text-sm",children:"You cannot use this feature while IMEI profiles are active."})]})}):(0,r.jsx)(m.I,{type:"text",id:"IMEI",value:j,onChange:e=>E(e.target.value),placeholder:w}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground font-medium",children:"This will reboot the device."})]})]})}),(0,r.jsx)(s.eW,{className:"grid border-t py-4",children:(0,r.jsx)(p.z,{type:"submit",className:"w-full",disabled:e||j===w,children:e?"Processing...":"Change IMEI"})})]})}),(0,r.jsxs)(s.Zb,{children:[(0,r.jsxs)(s.Ol,{children:[(0,r.jsx)(s.ll,{children:"ICCID Based IMEI Mangling"}),(0,r.jsxs)(s.SZ,{className:"flex items-center justify-between",children:["Change the IMEI of the device based on the ICCID.",(0,r.jsxs)("div",{className:"flex items-center text-orange-500",children:[(0,r.jsx)(f.Z,{className:"size-4 mr-1"}),"Do at your own risk!"]})]})]}),(0,r.jsxs)("form",{onSubmit:k,children:[(0,r.jsx)(s.aY,{children:(0,r.jsxs)("div",{className:"grid lg:grid-cols-2 grid-cols-1 grid-flow-row gap-4",children:[(0,r.jsxs)("div",{className:"grid w-full max-w-sm items-center gap-2",children:[(0,r.jsx)(h._,{htmlFor:"IMEI-prof1",children:"IMEI for Profile 1"}),e?(0,r.jsx)(v.O,{className:"h-8"}):(0,r.jsx)(m.I,{type:"text",id:"IMEI-prof1",placeholder:"IMEI for Profile 1",value:M.profile1.imei,onChange:e=>Z("profile1","imei",e.target.value)})]}),(0,r.jsxs)("div",{className:"grid w-full max-w-sm items-center gap-2",children:[(0,r.jsx)(h._,{htmlFor:"ICCID-prof1",children:"ICCID for Profile 1"}),e?(0,r.jsx)(v.O,{className:"h-8"}):(0,r.jsx)(m.I,{type:"text",id:"ICCID-prof1",placeholder:"ICCID for Profile 1",value:M.profile1.iccid,onChange:e=>Z("profile1","iccid",e.target.value)})]}),(0,r.jsx)(g.Z,{className:"col-span-full my-2"}),(0,r.jsxs)("div",{className:"grid w-full max-w-sm items-center gap-2",children:[(0,r.jsx)(h._,{htmlFor:"IMEI-prof2",children:"IMEI for Profile 2"}),e?(0,r.jsx)(v.O,{className:"h-8"}):(0,r.jsx)(m.I,{type:"text",id:"IMEI-prof2",placeholder:"IMEI for Profile 2",value:M.profile2.imei,onChange:e=>Z("profile2","imei",e.target.value)})]}),(0,r.jsxs)("div",{className:"grid w-full max-w-sm items-center gap-2",children:[(0,r.jsx)(h._,{htmlFor:"ICCID-prof2",children:"ICCID for Profile 2"}),e?(0,r.jsx)(v.O,{className:"h-8"}):(0,r.jsx)(m.I,{type:"text",id:"ICCID-prof2",placeholder:"ICCID for Profile 2",value:M.profile2.iccid,onChange:e=>Z("profile2","iccid",e.target.value)})]})]})}),(0,r.jsxs)(s.eW,{className:"grid grid-cols-2 grid-flow-row gap-6 border-t py-4",children:[(0,r.jsx)(p.z,{type:"submit",className:"w-full",disabled:e||i||!(M.profile1.imei!==N.profile1.imei||M.profile1.iccid!==N.profile1.iccid||M.profile2.imei!==N.profile2.imei||M.profile2.iccid!==N.profile2.iccid),children:i?"Saving...":"Save IMEI Profiles"}),(0,r.jsxs)(p.z,{type:"button",variant:"secondary",className:"w-full",onClick:z,disabled:e||l,children:[(0,r.jsx)(u.Z,{className:"h-4 w-4"}),l?"Deleting...":"Delete All Profiles"]})]})]})]})]})}},78580:function(e,t,i){"use strict";i.d(t,{d:function(){return n},z:function(){return d}});var r=i(20881),o=i(64149),s=i(54098),a=i(20116),l=i(90270);let n=(0,a.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),d=o.forwardRef((e,t)=>{let{className:i,variant:o,size:a,asChild:d=!1,...c}=e,f=d?s.g7:"button";return(0,r.jsx)(f,{className:(0,l.cn)(n({variant:o,size:a,className:i})),ref:t,...c})});d.displayName="Button"},94920:function(e,t,i){"use strict";i.d(t,{Ol:function(){return l},SZ:function(){return d},Zb:function(){return a},aY:function(){return c},eW:function(){return f},ll:function(){return n}});var r=i(20881),o=i(64149),s=i(90270);let a=o.forwardRef((e,t)=>{let{className:i,...o}=e;return(0,r.jsx)("div",{ref:t,className:(0,s.cn)("rounded-xl border bg-card text-card-foreground shadow",i),...o})});a.displayName="Card";let l=o.forwardRef((e,t)=>{let{className:i,...o}=e;return(0,r.jsx)("div",{ref:t,className:(0,s.cn)("flex flex-col space-y-1.5 p-6",i),...o})});l.displayName="CardHeader";let n=o.forwardRef((e,t)=>{let{className:i,...o}=e;return(0,r.jsx)("h3",{ref:t,className:(0,s.cn)("font-semibold leading-none tracking-tight",i),...o})});n.displayName="CardTitle";let d=o.forwardRef((e,t)=>{let{className:i,...o}=e;return(0,r.jsx)("p",{ref:t,className:(0,s.cn)("text-sm text-muted-foreground",i),...o})});d.displayName="CardDescription";let c=o.forwardRef((e,t)=>{let{className:i,...o}=e;return(0,r.jsx)("div",{ref:t,className:(0,s.cn)("p-6 pt-0",i),...o})});c.displayName="CardContent";let f=o.forwardRef((e,t)=>{let{className:i,...o}=e;return(0,r.jsx)("div",{ref:t,className:(0,s.cn)("flex items-center p-6 pt-0",i),...o})});f.displayName="CardFooter"},33335:function(e,t,i){"use strict";i.d(t,{I:function(){return a}});var r=i(20881),o=i(64149),s=i(90270);let a=o.forwardRef((e,t)=>{let{className:i,type:o,...a}=e;return(0,r.jsx)("input",{type:o,className:(0,s.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",i),ref:t,...a})});a.displayName="Input"},21501:function(e,t,i){"use strict";i.d(t,{_:function(){return d}});var r=i(20881),o=i(64149),s=i(51212),a=i(20116),l=i(90270);let n=(0,a.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=o.forwardRef((e,t)=>{let{className:i,...o}=e;return(0,r.jsx)(s.f,{ref:t,className:(0,l.cn)(n(),i),...o})});d.displayName=s.f.displayName},47657:function(e,t,i){"use strict";i.d(t,{Z:function(){return l}});var r=i(20881),o=i(64149),s=i(48897),a=i(90270);let l=o.forwardRef((e,t)=>{let{className:i,orientation:o="horizontal",decorative:l=!0,...n}=e;return(0,r.jsx)(s.f,{ref:t,decorative:l,orientation:o,className:(0,a.cn)("shrink-0 bg-border","horizontal"===o?"h-[1px] w-full":"h-full w-[1px]",i),...n})});l.displayName=s.f.displayName},88766:function(e,t,i){"use strict";i.d(t,{O:function(){return s}});var r=i(20881),o=i(90270);function s(e){let{className:t,...i}=e;return(0,r.jsx)("div",{className:(0,o.cn)("animate-pulse rounded-md bg-primary/10",t),...i})}},46646:function(e,t,i){"use strict";i.d(t,{pm:function(){return u}});var r=i(64149);let o=0,s=new Map,a=e=>{if(s.has(e))return;let t=setTimeout(()=>{s.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);s.set(e,t)},l=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:i}=t;return i?a(i):e.toasts.forEach(e=>{a(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===i||void 0===i?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},n=[],d={toasts:[]};function c(e){d=l(d,e),n.forEach(e=>{e(d)})}function f(e){let{...t}=e,i=(o=(o+1)%Number.MAX_SAFE_INTEGER).toString(),r=()=>c({type:"DISMISS_TOAST",toastId:i});return c({type:"ADD_TOAST",toast:{...t,id:i,open:!0,onOpenChange:e=>{e||r()}}}),{id:i,dismiss:r,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:i}})}}function u(){let[e,t]=r.useState(d);return r.useEffect(()=>(n.push(t),()=>{let e=n.indexOf(t);e>-1&&n.splice(e,1)}),[e]),{...e,toast:f,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},90270:function(e,t,i){"use strict";i.d(t,{cn:function(){return s}});var r=i(33958),o=i(61779);function s(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return(0,o.m6)((0,r.W)(t))}}},function(e){e.O(0,[59,714,420,829,985,330,744],function(){return e(e.s=36364)}),_N_E=e.O()}]);